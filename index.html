<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Portfolio</title>
    <link rel="stylesheet" href="index.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai+Looped:wght@100..900&family=Noto+Serif+Thai:wght@100..900&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Navigation -->
    <header>
        <nav>
            <img id="logo" src="" alt="Logo" class="logo">
            <div style="display:flex;align-items:center;gap:1rem">
                <ul id="nav-menu"></ul>
                <div class="language-toggle" role="tablist" aria-label="Language switch">
                    <button class="lang-btn" data-lang="en" aria-pressed="false">EN</button>
                    <button class="lang-btn" data-lang="th" aria-pressed="false">à¹„à¸—à¸¢</button>
                </div>
                <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">ðŸŒ™</button>
            </div>
        </nav>
    </header>

    <!-- Mobile Floating Theme Button -->
    <button id="theme-toggle-mobile" class="theme-toggle-mobile" aria-label="Toggle theme">ðŸŒ™</button>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <h1 id="hero-name"></h1>
        <p id="hero-tagline"></p>
        <a href="#projects" class="cta-button" id="hero-cta"></a>
    </section>

    <!-- Projects Section -->
    <section class="section" id="projects">
        <div class="container">
            <h2 id="projects-title"></h2>
            <div class="projects" id="projects-container"></div>
        </div>
    </section>

    <!-- Skills Section -->
    <section class="section" id="skills">
        <div class="container card">
            <h2 id="skills-title"></h2>
            <div class="skills" id="skills-container"></div>
        </div>
    </section>

    <!-- Contact Section -->
    <section class="contact-section" id="contact">
        <div class="container">
            <h2 id="contact-title"></h2>
            <p id="contact-message"></p>
            <div class="space"></div>
            <div class="contact-links" id="contact-links"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <p id="footer-text"></p>
    </footer>

    <script>
        let translations = {};
        let currentLanguage = localStorage.getItem('language') || 'en';

        // Load translations
        async function loadTranslations() {
            try {
                const response = await fetch('assets/data/translations.json');
                if (!response.ok) throw new Error('Failed to load translations');
                translations = await response.json();
                setLanguage(currentLanguage);
            } catch (error) {
                console.error('Error loading translations:', error);
                // Fallback: Use inline translations
                translations = {
                    "en": {
                        "nav": {
                            "home": "Home",
                            "projects": "Projects",
                            "skills": "Skills",
                            "contact": "Contact"
                        },
                        "hero": {
                            "name": "Phuwis Watthana",
                            "tagline": "Full Stack Developer | Creative Problem Solver",
                            "cta": "View My Work"
                        },
                        "projects": {
                            "title": "Featured Projects",
                            "items": [
                                {
                                    "title": "E-Commerce Platform",
                                    "description": "A full-stack web application built with React and Node.js. Features include product catalog, shopping cart, and payment integration.",
                                    "link": "#"
                                },
                                {
                                    "title": "Task Management App",
                                    "description": "A productivity tool with real-time collaboration features. Built with React, Firebase, and Material-UI for a modern user experience.",
                                    "link": "#"
                                },
                                {
                                    "title": "Weather Dashboard",
                                    "description": "An interactive weather application using APIs. Displays real-time weather data, forecasts, and location-based information.",
                                    "link": "#"
                                }
                            ]
                        },
                        "skills": {
                            "title": "Skills",
                            "items": [
                                {
                                    "category": "Frontend Development",
                                    "items": "React, NextJS, Vue.js, TypeScript, HTML5, CSS3, JavaScript, Flutter, Responsive Design"
                                },
                                {
                                    "category": "Backend Development",
                                    "items": "Node.js, Express, Python, REST APIs, MongoDB, PostgreSQL"
                                },
                                {
                                    "category": "DevOps & Infrastructure",
                                    "items": "Docker, AWS, Firebase, Git, Webpack, CI/CD"
                                },
                                {
                                    "category": "Core Competencies",
                                    "items": "System Design, Full-Stack Architecture, Problem Solving, Code Quality, Agile Development"
                                }
                            ]
                        },
                        "contact": {
                            "title": "Get In Touch",
                            "message": "I'm actively seeking full-time IT Solutions Architect opportunities. Let's connect to discuss how I can contribute to your organization.",
                            "email": "Email",
                            "linkedin": "LinkedIn",
                            "github": "GitHub"
                        },
                        "footer": {
                            "copyright": "Â© 2025 Phuwis Watthana. All rights reserved."
                        }
                    },
                    "th": {
                        "nav": {
                            "home": "à¸«à¸™à¹‰à¸²à¹à¸£à¸",
                            "projects": "à¹‚à¸„à¸£à¸‡à¸à¸²à¸£",
                            "skills": "à¸—à¸±à¸à¸©à¸°",
                            "contact": "à¸•à¸´à¸”à¸•à¹ˆà¸­"
                        },
                        "hero": {
                            "name": "à¸ à¸¹à¸§à¸´à¸¨ à¸§à¸±à¸’à¸™à¸°",
                            "tagline": "à¸™à¸±à¸à¸žà¸±à¸’à¸™à¸²à¹€à¸•à¹‡à¸¡à¸ªà¹à¸•à¹‡à¸ | à¸œà¸¹à¹‰à¹à¸à¹‰à¸›à¸±à¸à¸«à¸²à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¸ªà¸£à¸£à¸„à¹Œ",
                            "cta": "à¸”à¸¹à¸œà¸¥à¸‡à¸²à¸™à¸‚à¸­à¸‡à¸‰à¸±à¸™"
                        },
                        "projects": {
                            "title": "à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¸—à¸µà¹ˆà¸™à¸³à¹€à¸ªà¸™à¸­",
                            "items": [
                                {
                                    "title": "à¹à¸žà¸¥à¸•à¸Ÿà¸­à¸£à¹Œà¸¡à¸­à¸µà¸„à¸­à¸¡à¹€à¸¡à¸´à¸£à¹Œà¸‹",
                                    "description": "à¹à¸­à¸›à¸žà¸¥à¸´à¹€à¸„à¸Šà¸±à¸™à¹€à¸§à¹‡à¸šà¹à¸šà¸šà¹€à¸•à¹‡à¸¡à¸ªà¹à¸•à¹‡à¸à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¸”à¹‰à¸§à¸¢ React à¹à¸¥à¸° Node.js à¸¡à¸µà¸Ÿà¸µà¹€à¸ˆà¸­à¸£à¹Œà¸›à¸£à¸°à¸à¸­à¸šà¸”à¹‰à¸§à¸¢à¹à¸„à¸•à¸•à¸²à¸¥à¹‡à¸­à¸à¸ªà¸´à¸™à¸„à¹‰à¸² à¸•à¸°à¸à¸£à¹‰à¸²à¸à¸²à¸£à¸‹à¸·à¹‰à¸­ à¹à¸¥à¸°à¸à¸²à¸£à¸£à¸§à¸¡à¹€à¸‚à¹‰à¸²à¸”à¹‰à¸§à¸¢",
                                    "link": "#"
                                },
                                {
                                    "title": "à¹à¸­à¸›à¸ˆà¸±à¸”à¸à¸²à¸£à¸‡à¸²à¸™",
                                    "description": "à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¸œà¸¥à¸œà¸¥à¸´à¸•à¸—à¸µà¹ˆà¸¡à¸µà¸Ÿà¸µà¹€à¸ˆà¸­à¸£à¹Œà¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸£à¹ˆà¸§à¸¡à¸à¸±à¸™à¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œ à¸ªà¸£à¹‰à¸²à¸‡à¸”à¹‰à¸§à¸¢ React, Firebase à¹à¸¥à¸° Material-UI à¸ªà¸³à¸«à¸£à¸±à¸šà¸›à¸£à¸°à¸ªà¸šà¸à¸²à¸£à¸“à¹Œà¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸—à¸µà¹ˆà¸—à¸±à¸™à¸ªà¸¡à¸±à¸¢",
                                    "link": "#"
                                },
                                {
                                    "title": "à¹à¸”à¸Šà¸šà¸­à¸£à¹Œà¸”à¸­à¸²à¸à¸²à¸¨",
                                    "description": "à¹à¸­à¸›à¸žà¸¥à¸´à¹€à¸„à¸Šà¸±à¸™à¸ªà¸ à¸²à¸­à¸²à¸à¸²à¸¨à¹à¸šà¸šà¹‚à¸•à¹‰à¸•à¸­à¸šà¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ API à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸­à¸²à¸à¸²à¸¨à¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œ à¸à¸²à¸£à¸žà¸¢à¸²à¸à¸£à¸“à¹Œ à¹à¸¥à¸°à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸•à¸²à¸¡à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆ",
                                    "link": "#"
                                }
                            ]
                        },
                        "skills": {
                            "title": "à¸—à¸±à¸à¸©à¸°",
                            "items": [
                                {
                                    "category": "à¸à¸²à¸£à¸žà¸±à¸’à¸™à¸² Frontend",
                                    "items": "React, NextJS, Vue.js, TypeScript, HTML5, CSS3, JavaScript, Flutter, Responsive Design"
                                },
                                {
                                    "category": "à¸à¸²à¸£à¸žà¸±à¸’à¸™à¸² Backend",
                                    "items": "Node.js, Express, Python, REST APIs, MongoDB, PostgreSQL"
                                },
                                {
                                    "category": "DevOps à¹à¸¥à¸°à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸žà¸·à¹‰à¸™à¸à¸²à¸™",
                                    "items": "Docker, AWS, Firebase, Git, Webpack, CI/CD"
                                },
                                {
                                    "category": "à¸—à¸±à¸à¸©à¸°à¸«à¸¥à¸±à¸",
                                    "items": "à¸à¸²à¸£à¸­à¸­à¸à¹à¸šà¸šà¸£à¸°à¸šà¸š à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡à¹à¸šà¸šà¹€à¸•à¹‡à¸¡à¸ªà¹à¸•à¹‡à¸ à¸à¸²à¸£à¹à¸à¹‰à¸›à¸±à¸à¸«à¸² à¸„à¸¸à¸“à¸ à¸²à¸žà¹‚à¸„à¹‰à¸” à¸à¸²à¸£à¸žà¸±à¸’à¸™à¸² Agile"
                                }
                            ]
                        },
                        "contact": {
                            "title": "à¸•à¸´à¸”à¸•à¹ˆà¸­à¸‰à¸±à¸™",
                            "message": "à¸‰à¸±à¸™à¸à¸³à¸¥à¸±à¸‡à¸¡à¸­à¸‡à¸«à¸²à¹‚à¸­à¸à¸²à¸ªà¸‡à¸²à¸™à¹à¸šà¸šà¹€à¸•à¹‡à¸¡à¹€à¸§à¸¥à¸²à¹ƒà¸™à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡ IT Solutions Architect à¸¡à¸²à¸•à¸´à¸”à¸•à¹ˆà¸­à¹€à¸žà¸·à¹ˆà¸­à¸„à¸¸à¸¢à¸à¸±à¸™à¸§à¹ˆà¸²à¸‰à¸±à¸™à¸ªà¸²à¸¡à¸²à¸£à¸–à¸¡à¸µà¸ªà¹ˆà¸§à¸™à¸£à¹ˆà¸§à¸¡à¸•à¹ˆà¸­à¸­à¸²à¸ˆà¸²à¸£à¸¢à¹Œà¸‚à¸­à¸‡à¸„à¸¸à¸“à¹„à¸”à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£",
                            "email": "à¸­à¸µà¹€à¸¡à¸¥",
                            "linkedin": "LinkedIn",
                            "github": "GitHub"
                        },
                        "footer": {
                            "copyright": "Â© 2025 à¸ à¸¹à¸§à¸´à¸¨ à¸§à¸±à¸’à¸™à¸° à¸ªà¸‡à¸§à¸™à¸¥à¸´à¸‚à¸ªà¸´à¸—à¸˜à¸´à¹Œ"
                        }
                    }
                }
                setLanguage(currentLanguage);
            }
        }

        function setLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            document.documentElement.lang = lang;
            // Update language toggle UI buttons
            const btns = document.querySelectorAll('.lang-btn');
            btns.forEach(b => {
                const isActive = b.dataset.lang === lang;
                b.classList.toggle('active', isActive);
                b.setAttribute('aria-pressed', isActive ? 'true' : 'false');
            });
            loadPortfolio();
        }

        function t(path) {
            const keys = path.split('.');
            let value = translations[currentLanguage];
            for (let key of keys) {
                value = value?.[key];
            }
            return value || path;
        }

        // Theme switcher with localStorage
        function initTheme() {
            const stored = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', stored);
            updateThemeToggle(stored);
        }

        function updateThemeToggle(theme) {
            const btn = document.getElementById('theme-toggle');
            const btnMobile = document.getElementById('theme-toggle-mobile');
            if (btn) btn.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
            if (btnMobile) btnMobile.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
        }

        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme') || 'light';
            const next = current === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
            updateThemeToggle(next);

            // Animate both toggle buttons
            const btn = document.getElementById('theme-toggle');
            const btnMobile = document.getElementById('theme-toggle-mobile');
            if (btn) {
                btn.style.animation = 'spin 0.6s ease-in-out';
                setTimeout(() => {
                    btn.style.animation = '';
                }, 600);
            }
            if (btnMobile) {
                btnMobile.style.animation = 'spin 0.6s ease-in-out';
                setTimeout(() => {
                    btnMobile.style.animation = '';
                }, 600);
            }
        }

        // Scroll-triggered animations using Intersection Observer
        function initScrollAnimations() {
            const revealElements = document.querySelectorAll('.project-card, .skill-item, .section h2, #contact-title, #contact-message, .contact-links');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.15, rootMargin: '0px 0px -100px 0px' });

            revealElements.forEach(el => {
                el.classList.add('scroll-reveal');
                observer.observe(el);
            });
        }

        // Attach toggle listener when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            const toggle = document.getElementById('theme-toggle');
            const toggleMobile = document.getElementById('theme-toggle-mobile');
            if (toggle) toggle.addEventListener('click', toggleTheme);
            if (toggleMobile) toggleMobile.addEventListener('click', toggleTheme);
            // Language toggle buttons
            const langButtons = document.querySelectorAll('.lang-btn');
            if (langButtons.length) {
                langButtons.forEach(b => b.addEventListener('click', () => setLanguage(b.dataset.lang)));
            }
            loadTranslations();
        });

        // Load portfolio data from JSON
        async function loadPortfolio() {
            try {
                // Try to fetch the JSON file
                const response = await fetch('assets/data/portfolio.json');
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.json();
                // Convert portfolio.json format to match rendering expectations
                const portfolio = {
                    ...data.portfolio,
                    projects: {
                        title: t('projects.title'),
                        items: data.portfolio.projects
                    },
                    skills: {
                        title: t('skills.title'),
                        items: data.portfolio.skills
                    }
                };
                renderPortfolio(portfolio);
            } catch (error) {
                console.error('Error loading portfolio data:', error);
                renderPortfolioWithTranslations();
            }
        }

        function renderPortfolioWithTranslations() {
            const portfolio = {
                "title": "Phuwis - Portfolio",
                "logo": "assets/images/27002.jpg",
                "navigation": [
                    { "label": t('nav.home'), "href": "#home" },
                    { "label": t('nav.projects'), "href": "#projects" },
                    { "label": t('nav.skills'), "href": "#skills" },
                    { "label": t('nav.contact'), "href": "#contact" }
                ],
                "hero": {
                    "name": t('hero.name'),
                    "tagline": t('hero.tagline'),
                    "cta": t('hero.cta')
                },
                "projects": {
                    "title": t('projects.title'),
                    "items": translations[currentLanguage]?.projects?.items || []
                },
                "skills": {
                    "title": t('skills.title'),
                    "items": translations[currentLanguage]?.skills?.items || []
                },
                "contact": {
                    "title": t('contact.title'),
                    "message": t('contact.message'),
                    "links": [
                        { "label": t('contact.email'), "href": "mailto:phuwisw@gmail.com" },
                        { "label": t('contact.linkedin'), "href": "https://www.linkedin.com/in/phuwis-watthana-8205a437b/", "target": "_blank" },
                        { "label": t('contact.github'), "href": "https://github.com/phuwis", "target": "_blank" }
                    ]
                },
                "footer": {
                    "copyright": t('footer.copyright')
                }
            };
            renderPortfolio(portfolio);
        }

        function renderPortfolio(portfolio) {
            // Update page title
            document.title = portfolio.title;
            document.getElementById('page-title').textContent = portfolio.title;

            // Update logo
            document.getElementById('logo').src = portfolio.logo;

            // Update navigation
            const navMenu = document.getElementById('nav-menu');
            navMenu.innerHTML = '';
            portfolio.navigation.forEach(item => {
                const li = document.createElement('li');
                const a = document.createElement('a');
                a.href = item.href;
                a.textContent = item.label;
                li.appendChild(a);
                navMenu.appendChild(li);
            });

            // Update hero section
            document.getElementById('hero-name').textContent = portfolio.hero.name;
            document.getElementById('hero-tagline').textContent = portfolio.hero.tagline;
            document.getElementById('hero-cta').textContent = portfolio.hero.cta;

            // Handle projects (could be array or object with items)
            const projectsData = Array.isArray(portfolio.projects) ? portfolio.projects : portfolio.projects?.items || [];
            const projectsTitle = portfolio.projects?.title || t('projects.title');

            // Update projects title
            document.getElementById('projects-title').textContent = projectsTitle;

            // Update projects
            const projectsContainer = document.getElementById('projects-container');
            projectsContainer.innerHTML = '';
            projectsData.forEach((project, idx) => {
                const card = document.createElement('div');
                card.className = 'project-card';
                card.innerHTML = `
                    <div class="project-image">Project ${idx + 1}</div>
                    <div class="project-info">
                        <h3>${project.title}</h3>
                        <p>${project.description}</p>
                        <a href="${project.link}" class="project-link">View Project â†’</a>
                    </div>
                `;
                projectsContainer.appendChild(card);
            });

            // Handle skills (could be array or object with items)
            const skillsData = Array.isArray(portfolio.skills) ? portfolio.skills : portfolio.skills?.items || [];
            const skillsTitle = portfolio.skills?.title || t('skills.title');

            // Update skills title
            document.getElementById('skills-title').textContent = skillsTitle;

            // Update skills
            const skillsContainer = document.getElementById('skills-container');
            skillsContainer.innerHTML = '';
            skillsData.forEach(skill => {
                const item = document.createElement('div');
                item.className = 'skill-item';
                item.innerHTML = `
                    <h3>${skill.category}</h3>
                    <p>${skill.items}</p>
                `;
                skillsContainer.appendChild(item);
            });

            // Update contact section
            document.getElementById('contact-title').textContent = portfolio.contact.title;
            document.getElementById('contact-message').textContent = portfolio.contact.message;

            const contactLinks = document.getElementById('contact-links');
            contactLinks.innerHTML = '';
            portfolio.contact.links.forEach(link => {
                const a = document.createElement('a');
                a.href = link.href;
                a.textContent = link.label;
                if (link.target) a.target = link.target;
                a.style.display = 'inline-block';
                contactLinks.appendChild(a);
            });

            // Update footer
            document.getElementById('footer-text').textContent = portfolio.footer.copyright;

            // Re-initialize scroll animations after content is rendered
            initScrollAnimations();
        }

        // Smooth scrolling for navigation links
        document.addEventListener('click', function (e) {
            if (e.target.tagName === 'A' && e.target.getAttribute('href').startsWith('#')) {
                e.preventDefault();
                const target = document.querySelector(e.target.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            }
        });
        // After rendering, attach interactive handlers
        function attachInteractions() {
            // Make project cards keyboard/click accessible and open modal
            const projects = document.querySelectorAll('.project-card');
            projects.forEach((card, idx) => {
                card.tabIndex = 0;
                card.setAttribute('role', 'button');
                card.addEventListener('click', () => openProjectModal(idx));
                card.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openProjectModal(idx); } });
                card.addEventListener('mouseover', () => card.classList.add('hover'));
                card.addEventListener('mouseout', () => card.classList.remove('hover'));
            });

            // Contact links: copy email on click if mailto
            const contactLinks = document.querySelectorAll('#contact-links a');
            contactLinks.forEach(a => {
                a.tabIndex = 0;
                a.addEventListener('keydown', (e) => { if (e.key === 'Enter') a.click(); });
                if (a.href && a.href.startsWith('mailto:')) {
                    a.addEventListener('click', (ev) => {
                        ev.preventDefault();
                        const email = a.href.replace('mailto:', '');
                        navigator.clipboard?.writeText(email).then(() => {
                            const originalText = a.textContent;
                            a.textContent = originalText + ' (copied)';
                            setTimeout(() => a.textContent = originalText, 1500);
                        }).catch(() => {
                            // fallback: open mail client
                            window.location.href = a.href;
                        });
                    });
                }
            });

            // Nav links: keyboard navigation support
            const navLinks = document.querySelectorAll('#nav-menu a');
            navLinks.forEach((link, i) => {
                link.tabIndex = 0;
                link.addEventListener('keydown', (e) => {
                    if (e.key === 'ArrowRight') navLinks[(i + 1) % navLinks.length].focus();
                    if (e.key === 'ArrowLeft') navLinks[(i - 1 + navLinks.length) % navLinks.length].focus();
                });
            });
        }

        // Simple modal implementation
        const modal = (() => {
            let currentIndex = null;
            const modalEl = document.createElement('div');
            modalEl.id = 'modal';
            modalEl.className = 'modal';
            modalEl.innerHTML = `
                <div class="modal-backdrop" data-close></div>
                <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="modal-title">
                    <button class="modal-close" aria-label="Close" data-close>Ã—</button>
                    <h3 id="modal-title"></h3>
                    <p id="modal-body"></p>
                    <a id="modal-link" class="project-link" href="#" target="_blank">Open Project</a>
                </div>
            `;
            document.body.appendChild(modalEl);

            function open(index, project) {
                currentIndex = index;
                modalEl.querySelector('#modal-title').textContent = project.title;
                modalEl.querySelector('#modal-body').textContent = project.description;
                const link = modalEl.querySelector('#modal-link');
                link.href = project.link || '#';
                modalEl.classList.add('open');
                modalEl.setAttribute('aria-hidden', 'false');
                // trap focus
                modalEl.querySelector('.modal-close').focus();
                document.addEventListener('keydown', onKey);
            }

            function close() {
                modalEl.classList.remove('open');
                modalEl.setAttribute('aria-hidden', 'true');
                document.removeEventListener('keydown', onKey);
            }

            function onKey(e) {
                if (e.key === 'Escape') close();
            }

            modalEl.addEventListener('click', (ev) => {
                if (ev.target.matches('[data-close]')) close();
            });

            return { open, close };
        })();

        function openProjectModal(idx) {
            // get project data from DOM: index matches order
            const projects = document.querySelectorAll('#projects-container .project-card');
            const p = projects[idx];
            if (!p) return;
            const title = p.querySelector('h3')?.textContent || 'Project';
            const desc = p.querySelector('p')?.textContent || '';
            const link = p.querySelector('a.project-link')?.href || '#';
            modal.open(idx, { title, description: desc, link });
        }

        // Re-run attachInteractions after portfolio is rendered
        const observer = new MutationObserver((m) => {
            const projectsContainer = document.getElementById('projects-container');
            if (projectsContainer && projectsContainer.children.length) {
                attachInteractions();
                observer.disconnect();
            }
        });
        observer.observe(document.body, { childList: true, subtree: true });

        // Smooth scrolling for navigation links (delegated)
        document.addEventListener('click', function (e) {
            const el = e.target.closest('a');
            if (!el) return;
            const href = el.getAttribute('href');
            if (href && href.startsWith('#')) {
                e.preventDefault();
                const target = document.querySelector(href);
                if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });
    </script>
</body>

</html>